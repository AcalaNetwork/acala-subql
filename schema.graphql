type KVData @jsonField {
  key: String
  value: String
  type: String
}

type SystemConsts @entity {
  id: ID!
  liquidToken: Token
  stakignToken: Token
  nativeToken: Token
  stableToken: Token
}

type Block @entity {
  id: ID!

  number: BigInt
  timestamp: Date
  parentHash: String
  specVersion: String
  stateRoot: String
  extrinsicRoot: String

  extrinsics: [Extrinsic] @derivedFrom(field: "block")
  events: [Event] @derivedFrom(field: "block")
}

type Extrinsic @entity {
  id: ID!

  method: String
  section: String
  args: [KVData]
  signer: Account
  nonce: BigInt
  timestamp: Date
  signature: String
  tip: String
  isSigned: Boolean
  isSuccess: Boolean

  block: Block

  events: [Event] @derivedFrom(field: "extrinsic")
  calls: [Call] @derivedFrom(field: "extrinsic")
}

type Event @entity {
  id: ID!

  index: Int
  section: String
  method: String
  data: [KVData]

  block: Block
  extrinsic: Extrinsic
}

type Call @entity {
  id: ID!

  section: String
  method: String
  args:[KVData] 
  timestamp: Date
  isSuccess: Boolean

  signer: Account
  extrinsic: Extrinsic
  parentCall: Call

  calls: [Call] @derivedFrom(field: "parentCall")
}

type Account @entity {
  id: ID!

  txCount: Int
  createAtBlock: Block

  extrinsics: [Extrinsic] @derivedFrom(field: "signer")
  calls: [Call] @derivedFrom(field: "signer")
  transferIn: [Transfer] @derivedFrom(field: "to")
  transferOut: [Transfer] @derivedFrom(field: "from")
  position: [LoanPosition] @derivedFrom(field: "account")
}

type Price @entity {
  id: ID!

  price: String
  token: String

  createAtBlockNumber: BigInt
}

type Token @entity {
  id: ID!

  symbol: String
  decimal: Int
}

type Asset @entity {
  id: ID!

  token: Token
  account: Account

  free: String
  frozen: String
  reserved: String

  total: String
  totalInUSD: String
}

type AccountAssetDayData @entity {
  id: ID!

  account: Account
  totalInUSD: String
  timestamp: Date
}

type OracleFeedRecord @entity {
  id: ID!

  token: Token
  account: Account
  provider: String

  feedPrice: String

  updateAtBlock: Block
}

type OracleFeedHourData @entity {
  id: ID!

  token: Token
  account: Account
  provider: String

  averagePrice: String

  timestamp: Date
}

type Transfer @entity {
  id: ID!

  from: Account
  to: Account
  token: Token
  amount: String
  amountInUSD: String

  extrinsic: Extrinsic
  call: Call
  timestamp: Date
  isSuccess: Boolean
}

#
#type LoanDayData @entity {
#  id: ID!
#
#  token: String!
#  timestamp: Date!
#
#  collateral: BigInt!
#  debit: BigInt!
#}
#

type LoanPosition @entity {
  id: ID!

  account: Account
  token: Token

  debit: BigInt
  collateral: BigInt
}

type LoanAction @entity {
  id: ID!

  account: Account
  token: Token
  collateral: BigInt
  debit: BigInt
  exchangeRate: BigInt

  extrinsic: Extrinsic #create relation to extrinsic
  call: Call #create relation to call
  timestamp: Date
  isSuccess: Boolean
}

#type Pair @entity {
#  id: ID!
#
#  token0: String!
#  token1: String!
#  totalSupply: BigInt!
#
#  token0Volume: BigInt!
#  token1Volume: BigInt!
#
#  token0USD: BigInt!
#  token1USD: BigInt!
#
#  token0Price: BigInt!
#  token1Price: BigInt!
#
#  txCount: BigInt!
#}
#
#type SwapAction @entity {
#  id: ID!
#  isBatch: Int!
#  isSudo: Int!
#  isSuccess: Int!
#
#  block: String!
#  extrinsicHash: String!
#  timestamp: Date!
#
#  account: String!
#  type: String!
#  path: String!
#  token0: String!
#  token1: String!
#  token0Input: String!
#  token1Input: String!
#  result: String!
#}
#
#type AddLiquidityHistory @entity {
#  id: ID!
#  isBatch: Int!
#  isSudo: Int!
#  isSuccess: Int!
#
#  block: String!
#  extrinsicHash: String!
#  timestamp: Date!
#
#  account: String!
#  token0: String!
#  token1: String!
#
#  token0Input: BigInt!
#  token1Input: BigInt!
#
#  token0Amount: BigInt!
#  token1Amount: BigInt!
#  receivedShare: BigInt!
#}
#
#type RemoveLiquidityHistoryEntity @entity {
#  id: ID!
#  isBatch: Int!
#  isSudo: Int!
#  isSuccess: Int!
#
#  block: String!
#  timestamp: Date!
#
#  account: String!
#  token0: String!
#  token1: String!
#  removedShare: BigInt!
#
#  token0Amount: BigInt!
#  token1Amount: BigInt!
#}
#